
    <%- include('../layout/header.ejs') %>
    <style>
        .offer-container {
            display: flex;
            justify-content: space-between; /* Adjust as needed */
        }
    
        .offer-box {
            border: 2px solid #4CAF50;
            border-radius: 8px;
            padding: 20px;
            width: 300px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease-in-out;
    
        }
    
        .offer-box:hover {
            transform: scale(1.05);
        }
    
        .offer-box h5 {
            color: #333;
            font-size: 18px;
            margin-bottom: 10px;
            text-decoration: underline;
            text-decoration-style: double; /* You can use other values like solid, dashed, dotted, etc. */
    text-decoration-color: #4CAF50; 
        }
    
        .offer-box p {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
    
        .percentage {
            font-weight: bold;
            font-size: 28px;
            color: #E44D26; /* Adjust color as needed */
        }
    </style>
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
    
</head>
<body>
    <% if (getallProduct) { %>
    <div class="container-fluids">
        <div class="cart">
            <div class="row row1">
                <div class="col-md-4">
                    <img src="/productImage/<%= getallProduct.images[0] %>" width="100%" id="ProductImg">
                    <div class="small-imgs">
                        <img src="/productImage/<%= getallProduct.images[1] %>" width="100%" class="small-img">
                        <img src="/productImage/<%= getallProduct.images[2] %>" width="100%" class="small-img">
                        <img src="/productImage/<%= getallProduct.images[3] %>" width="100%" class="small-img">
                        <img src="/productImage/<%= getallProduct.images[0] %>" width="100%" class="small-img">
                    </div>                
                </div>
               
                <div class="col-md-6">        
                    <h1 class="product-title"><%= getallProduct.title %></h1>
                    <h5><%= getallProduct.description %> </h5>

                    <div class="reviews">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                        <i class="far fa-star"></i>
                        <p>05 reviews</p>
                    </div>
                    <div class="price">
                        <% if (offers && offers.length > 0) { %>
                            <% 
                                const originalPrice = getallProduct.price;
                                const discountPercentage = offers[0].offer.percentage;
                                const discountedPrice = originalPrice - (originalPrice * (discountPercentage / 100));
                                const roundedDiscountedPrice = Math.round(discountedPrice);
                            %>
                            <span><%= roundedDiscountedPrice %> <span>(after <%= discountPercentage %>% off)</span></span>
                        <% } else { %>
                            <span><%= getallProduct.price %></span>
                        <% } %>
                        
                        <span><%= getallProduct.price %></span>
                    </div>
                    <hr>
                    <h4>
                        <i class="fas fa-gift"></i> Offers
                        <div class="offer-container">
                            <% if (offers && offers.length > 0) { %>
                                <% for (let i = 0; i < offers.length; i++) { %>
                                    <div class="offer-box">
                                        <h5><%= offers[i].offer.offer_name %></h5>
                                        <p>
                                            <strong>Cash Back:</strong>
                                            <span class="percentage"><%= offers[i].offer.percentage %>%</span>
                                        </p>
                                        <p><strong>Description:</strong> <%= offers[i].offer.description %></p>
                                    </div>
                                <% } %>
                            <% } else { %>
                                <p>No Offers Available</p>
                            <% } %>
                        </div>
                    </h4>
                    
                    <hr>

                    <input type="hidden" name="price" id="price" value="<%= getallProduct.price %>">

                    <div class="row">
                       
                        
                    </div>
                    <div class="buttons">
                        <div class="row">
                            <!-- <div class="col-md-6">
                                <a href="#" class="custom-btn">Add To Cart <i class="fas fa-angle-right"></i></a>
                            </div> -->
                            <!-- Example EJS template code -->
<!-- ... (previous code) ... -->

<div class="col-md-6">
  <!-- Add a form for adding the product to the cart -->
  <form action="" method="POST">
      <!-- Hidden input for the product ID -->
      <input type="hidden" name="productId" id="productId" value="<%= getallProduct._id %>">
      <div class="col-md-4 qty">
        <h5>Quantity</h5>
        <select class="quantity custom-select" name="quantity" id="quantity">
          <% for (let i = 1; i <= getallProduct.quantity; i++) { %>
            <option value="<%= i %>"><%= i %></option>
          <% } %>
          <% if(getallProduct.quantity ===0) { %>
          <option value="0">Sorry !! Out of Stock</option>
          <% } %>
        </select>
        
    </div>
    <input type="hidden" name="cart" id="cart" value="<%= JSON.stringify(cart) %>">

    <% if(getallProduct.quantity ===0) { %>
      <button type="button" class="custom-btn">Notify Me <i class="fas fa-angle-right"></i></button>
      <% }else{ %>
      <button type="submit" id="addToCartLink" class="custom-btn">Add To Cart <i class="fas fa-angle-right"></i></button>
      <%}%>
  </form>
</div>

<!-- ... (rest of your code) ... -->
<% if(getallProduct.quantity ===0) { %>
  <% }else{ %>
                            <div class="col-md-6"> 
                                <a href="#" class="custom-btn">Buy Now <i class="fas fa-angle-right"></i></a>
                            </div>   <%}%>
                        </div>
                        
                    </div>
                    
                    <div id="product" class="product-inf">
                       
                      <% } else { %>
                        <p>Product not found</p>
                    <% } %>
                   
                </div><br><br> <a href="/add-wishlist"></a>
                <button type="submit" id="addTowishList" class="wishlist-button">❤️ Add To Wish List</button>
               </a>

            </div>
        

        </div>
        
    </div>
    <br>
    
    <div class="text-center">
      <p class="d-inline-flex gap-1">
          <a class="btn btn-primary" data-bs-toggle="collapse" href="#multiCollapseExample1" role="button" aria-expanded="false" aria-controls="multiCollapseExample1">Get More Information Of Your Product</a>
      </p>
  </div>
  
  <div class="row justify-content-center">
      <div class="col">
          <div class="collapse multi-collapse" id="multiCollapseExample1">
              <div class="card card-body">
                  <%= getallProduct.productDetails %>
              </div>
          </div>
      </div>
  </div>
  
  <div class="text-center">
      <p class="d-inline-flex gap-1">
          <a class="btn btn-primary" data-bs-toggle="collapse" href="#multiCollapseExample" role="button" aria-expanded="false" aria-controls="multiCollapseExample1">Know More Specification</a>
      </p>
  </div>
  
  <div class="row justify-content-center">
      <div class="col">
          <div class="collapse multi-collapse" id="multiCollapseExample">
              <div class="card card-body">
                  <%= getallProduct.specification %>
              </div>
          </div>
      </div>
  </div>
  
  <div class="text-center">
      <p class="d-inline-flex gap-1">
          <a class="btn btn-primary" data-bs-toggle="collapse" href="#multiCollapseExample2" role="button" aria-expanded="false" aria-controls="multiCollapseExample2">Check For the Warranty Details</a>
      </p>
  </div>
  
  <div class="row justify-content-center">
      <div class="col">
          <div class="collapse multi-collapse" id="multiCollapseExample2">
              <div class="card card-body">
                  <%= getallProduct.warranty %>
              </div>
          </div>
      </div>
  </div>
  
  <div class="text-center">
      <p class="d-inline-flex gap-1">
          <a class="btn btn-primary" data-bs-toggle="collapse" href="#multiCollapseExample3" role="button" aria-expanded="false" aria-controls="multiCollapseExample2">More Details Other than this </a>
      </p>
  </div>
  
  <div class="row justify-content-center">
      <div class="col">
          <div class="collapse multi-collapse" id="multiCollapseExample3">
            <div class="card card-body">
              <p>Contact US for More Details fusionfurni@gmail.com</p>
          </div>
             
          </div>
      </div>
  </div>
               
                      </body>
                      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- BOOTSTRAP JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <!-- FONT AWESOME -->
    <script src="https://kit.fontawesome.com/4077c6ef6a.js" crossorigin="anonymous"></script>
    <script src="/js/ja.js"></script>

    <%- include('../layout/footer.ejs') %>


<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
  document.getElementById('addToCartLink').addEventListener('click', function (event) {
    event.preventDefault(); // Prevent the default navigation behavior
    const quantity = document.getElementById('quantity').value;
    const productId = document.getElementById('productId').value;
    const cart = JSON.parse(document.getElementById('cart').value);
    const price = document.getElementById('price').value;;
    // Create a data object containing the quantity and productId
    const data = {
      quantity: quantity,
      productId: productId,
      cart: cart, 
      price:price
    };

    // Your Axios code to send a request to the server with the data in the request body
    axios.post('/cart', data)
      .then(response => {
        // Handle the response from the server if needed
        console.log(response.data);
      })
      .catch(error => {
        console.error('Error:', error);
      });
  });
  document.getElementById('addTowishList').addEventListener('click', function (event) {
    event.preventDefault(); // Prevent the default navigation behavior
    const productId = document.getElementById('productId').value;
    // Create a data object containing the quantity and productId
    const data = {
      productId: productId,
    };

    // Your Axios code to send a request to the server with the data in the request body
    axios.post('/add-wishlist', data)
      .then(response => {
        // Handle the response from the server if needed
        console.log(response.data);
      })
      .catch(error => {
        console.error('Error:', error);
      });
  });
</script>
