<%- include('header.ejs') %>
<link rel="stylesheet" type="text/css" href="print.css">
<!-- Include Print.js JavaScript file -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js"></script>


<link rel="stylesheet" type="text/css" href="print.css">
<!-- Include Print.js CSS file -->
<link rel="stylesheet" type="text/css" href="https://printjs-4de6.kxcdn.com/print.min.css">
<script src="print.js"></script>
<body>
  <div class="screen-overlay"></div>
  
 
    <section class="content-main">
      <div class="content-header">
        <div>
          <h2 class="content-title card-title">Sales Report</h2>
          <p>Here you can see the sales report of your business</p>
        </div>
      
      </div>

      <!-- Heading for User List -->

      <!-- User List -->
      <div class="card mb-4">
        <div class="card-body">
          <!-- Loop through users -->
          <article class="itemlist">
            <div class="row align-items-center">
                <div class="card-body">
                    <div class="table-responsive">
                      <div class="table-responsive">
                        <table class="table align-middle table-nowrap mb-0">
                            <thead class="table-light">
                              <tr>
                                <th scope="col" class="text-center">
                                  <div class="form-check align-middle">
                                    <label class="form-check-label" for="transactionCheck01"></label>
                                  </div>
                                </th>
                                <th class="align-middle" scope="col">Order ID</th>
                                <th class="align-middle" scope="col">User Name</th>
                                <th class="align-middle" scope="col">Product Name</th>
                                <th class="align-middle" scope="col">Total</th>
                                <th class="align-middle" scope="col">Payment Status</th>
                                <th class="align-middle" scope="col">Payment Method</th>
                                <th class="align-middle" scope="col">Ordered Date & Time</th>
                              </tr>
                            </thead>
                            <tbody>
                              <% userorders.reverse().forEach(order => { %>
                                <% order.products.forEach((productItem, index, array) => { %>
                                  <tr>
                                    <td class="text-center"></td>
                                    <td>
                                      <p class="fw-bold"><%= order.orderId %></p>
                                    </td>
                                    <td>
                                      <% order.populatedOrderBy.forEach(user => { %>
                                        <%= user.name %>
                                      <% }); %>
                                    </td>
                                    <td>
                                      <% order.populatedProducts.forEach(product => { %>
                                        <%= product.title %>
                                      <% }); %>
                                    </td>
                                    <td><%= order.paymentIntent.amount %></td>
                                    <td><%= order.paymentIntent.status %></td>
                                    <td><%= order.paymentIntent.method %></td>
                                    <td>
                                      <% if (index === array.length - 1) { %>
                                        <strong>
                                          <p>
                                            <%= new Date(order.createdAt).toLocaleString("en-US", {
                                              year: 'numeric',
                                              month: '2-digit',
                                              day: '2-digit',
                                              hour: '2-digit',
                                              minute: '2-digit',
                                              second: '2-digit'
                                            }) %>
                                          </p>
                                        </strong>
                                      <% } %>
                                    </td>
                                  </tr>
                                <% }); %>
                              <% }); %>
                            </tbody>
                          </table>
                          
                    </div>
                    </div>
            </div>
          </article>
         
          
        </div>
      </div>
      <!-- <div class="container text-center mt-4">
        <button type="button" onclick="printWithHeader()">
            Print header raw HTML
          </button>
      </div> -->
      <div class="container text-center mt-4">
        <button type="button" onclick="printScreen()">
          Print Screen
        </button>
      </div>
    </section>

    <!-- content-main end// -->
    <%- include('footer.ejs') %>
  </main>
</body>
<script>
  function printScreen() {
    window.print();
  }
</script>
<script>
    const someJSONdata = []
    
  
  
    function printWithHeader() {
      printJS({
        printable: someJSONdata,
        type: 'json',
        properties: ['name', 'email', 'phone'],
        header: '<h3 class="custom-h3">My custom header</h3>',
        style: '.custom-h3 { color: red; }'
      });
    }
  </script>
